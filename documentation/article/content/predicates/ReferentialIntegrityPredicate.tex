\subsection{ReferentialIntegrityPredicate}
ReferentialIntegrityPredicate asserts that there is referential integrity between all tables of  a DW. This means that each row of a table with a foreign key, has a corresponding row in the table to which it is referring. Referential integirty is not always upheld during load, so a tester may want to assert this property. This predicate takes no parameters for its instatiation, and it is simply run on the DWRepresentation corresponding to the test DW .

ReferentialIntegrityPredicate makes use of the DWRepresentation object's \emph{refs} field, which is similar to \emph{refs} used in pygramETL's snowflaked dimensions. \emph{refs} is a dictionary with referring tables as keys and lists of tables as values as described in \cref{sect:interdatarep}. ReferentialIntegrityPredicate uses this to create a dictionary of dictionaries that holds more information on the references. These inner dictionaries will have foreign keys as their key with the referenced table as the value. In this way it is easy to look up what the foreign keys are called, and what they refer to. We can theno iterate over the tables, their rows, and comparing their keys that they have in common. After iterating between a referring table and a referred table, the checks are made again by iterating over the referred table's rows first. This is done because the new \emph{refs} have no information on the tables a table is referred by, only what it refers to. If the predicate fails to find a corresponding id for a row in another table, it takes note of the two tables and the key for reporting. Currently works with facttables and snowflaked dimensions.