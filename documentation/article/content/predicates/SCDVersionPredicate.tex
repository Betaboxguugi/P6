\subsection{SCDVersionPredicate}\label{SCD}

This predicate allows testers to check if a given entry in a table has an asserted largest version. This predicate only works on SCDType2Representation objects, which represent type 2 slowly changing dimensions. SCDVersionPredicate is instantiated with parameters as depicted below.

\insertcodefile{SCDVersionPredicate.py}{Instantiation of RuleColumnPredicate}

\begin{description}
\item [entry] A dictionary pairing lookup attributes from the table with values. This indicates a unique entry in the table, which may have several different versions. 
\item [version] A number indicating the largest version that the entry is asserted to have.
\end{description}

In the instantiation, we use the predicate to assert that The Hobbit's highest version number in BookDim is 10.

The predicate works by iterating over each row of the table. Once we find a row that matches the test entry, we check whether its version is bigger than any found before. If yes, we update the value of our largest version. After processing the table, we try to equate the largest version with the one asserted by the tester. If they are equal, the predicate succeeds, and it fails otherwise.   
